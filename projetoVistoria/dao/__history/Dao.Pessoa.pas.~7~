unit Dao.Pessoa;

interface
uses
System.Generics.Collections, DBXJSON, DBXJSONReflect, BD.Connection,
  FireDAC.Comp.Client, SysUtils, Pessoa, FireDAC.Phys.Intf, FireDAC.DApt;

type
  TPessoaDao = class
  private
    class function Create (APessoa: TPessoa): TPessoa;
    class function Update (APessoa: TPessoa): TPessoa;
    class procedure Consolidate (var APessoa: TPessoa; AQuery : TFDQuery);
  public
    class function Read(): TObjectList<TPessoa>; overload;
    class function Read(AIdPessoa: Integer) : TPessoa; overload;
    class function Save(APessoa : TPessoa): TPessoa;
    class procedure Delete (AIdPessoa: Integer);
  end;

implementation

{ TPessoaDao }


{ TPessoaDao }

class procedure TPessoaDao.Consolidate(var APessoa: TPessoa; AQuery: TFDQuery);
begin
  with AQuery do
  begin
    APessoa.IdPessoa := FindField('idpessoa').AsInteger;
    APessoa.Nome := FindField('nome').AsString;
  end;
end;

class function TPessoaDao.Create(APessoa: TPessoa): TPessoa;
var
  Con : TFDConnection;
  QueryString : string;
  IdPessoa: Integer;
begin
  Con := TConnection.getConnection;

  QueryString := Format(
  'INSERT INTO aula.cadpessoa (nome) VALUES ( ''%s'' ) RETURNING idpessoa',
  [APessoa.Nome]);

end;

class procedure TPessoaDao.Delete(AIdPessoa: Integer);
var
  Con : TFDConnection;
  QueryString: string;
begin
  Con := TConnection.getConnection;
  QueryString := Format('DELETE FROM aula.cadpessoa WHERE idpessoa = %d ',
  [AidPessoa]
  );

end;

class function TPessoaDao.Read(AIdPessoa: Integer): TPessoa;
begin

end;

class function TPessoaDao.Read: TObjectList<TPessoa>;
begin

end;

class function TPessoaDao.Save(APessoa: TPessoa): TPessoa;
begin

end;

class function TPessoaDao.Update(APessoa: TPessoa): TPessoa;
begin

end;

end.
